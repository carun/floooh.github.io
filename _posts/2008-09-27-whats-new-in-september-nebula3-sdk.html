---
layout: post
title: What's New in the September Nebula3 SDK
date: '2008-09-27T15:05:00.002+01:00'
author: Andre Weissflog
tags: 
modified_time: '2008-09-27T15:07:53.013+01:00'
blogger_id: tag:blogger.com,1999:blog-2948438400037317662.post-2321468467597118783
blogger_orig_url: http://flohofwoe.blogspot.com/2008/09/whats-new-in-september-nebula3-sdk.html
---

<div style="HEIGHT:0px"><br /></div><div><div style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px">I finally got around to pack a new N3 SDK together. I'll upload it on Monday when I'm back in the office, in the meantime here's a rough What's New list. A lot of under-the-hood-stuff has changed, and I had to remove a few of the fancy front-end-features for now (for instance, the N2 character rendering had to be removed when I implemented the multi-threaded renderer, and the shader lighting code is broken at the moment). I'll care about this front-end stuff in the next release.<br /></div><div style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px"><br /></div><h3><span class="Apple-style-span" style="font-size: 16px; ">General Stuff</span><br /></h3><ul style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px"><br />  <li style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px">changes to enable mixing Nebula2 and Nebula3 code, mainly macro names are affected (DeclareClass -> __DeclareClass, ImplementSingleton -> __ImplementSingleton etc...)<br />  </li><li style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px">started to remove #ifndef/#define/#endif include guards since pretty much all relevant compilers (VStudio, GCC, Codewarrior) support #pragma once <br />  </li><li style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px">moved identical Win32 and Xbox360 source code into a common Win360 namespace to eliminate code redundancies</li><li style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px">added a new Toolkit Layer which contains helper classes and tools for asset export<br />  </li><li style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px">added and fixed some Doxygen pages<br />  </li><br /></ul><h3>Build System<br /></h3><ul style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px"><li>re-organized VStudio solution structure, keeps all dependent projects in the same solution, so it's no longer necessary to have several VStudios open at the same time<br />  </li><li>it's possible now to import VStudio projects through the .epk build scripts (useful for actual Nebula3 projects which do not live under the Nebula3 SDK directory)<br />  </li><li>new "projectinfo.xml" file which defines project- and platform-specific attributes for the asset batch-export tools<br />  </li><li>split the export.zip archive into one platform-neutral and several platform-specific archives (export.zip contains all platform-independent files, export_win32.zip, export_xbox360.zip, export_wii.zip contain the platform-specific stuff)<br />  </li><li>added general multiplatform-support to the asset-pipeline (e.g. "msbuild /p:Platform=xbox360" to build Xbox360-assets)<br />  </li><li>new command-line build tools (with source):<br />  </li><ul style="MARGIN-TOP:0px; MARGIN-BOTTOM:0px"><li>audiobatcher3.exe (wraps audio export)</li><li>texturebatcher3.exe (wraps texture export)</li><li>shaderbatcher3.exe (wraps shader compilation)</li><li>buildresdict.exe (generates resource dictionary files)</li><li>these tools mostly just call other build tools (like xactbld3.exe, nvdxt.exe, or build tools for game-console SDKs)<br />    </li></ul><li>note that the public N3-SDK only contains Win32 support for obvious legal reasons </li></ul><h3>    Foundation Layer<br /></h3><ul><li>fixed thread-safety bugs in Core::RefCounted and Util::Proxy refcounting code<br />    </li><li>added WeakPtr&lt;> class for better handling of cyclic references<br />    </li><li>added type-cast methods to Ptr&lt;><br />    </li><li>simplified the System::ByteOrder class interface<br />    </li><li>added platform-specific task-oriented "virtual CPU core id's" (e.g. MainThreadCode, RenderThreadCore, etc...)<br />    </li><li>added a System::SystemInfo class<br />    </li><li>added Threading::ThreadId type and static Threading::Thread::GetMyThreadId() method<br />    </li><li>proper thread names are now visible in the VStudio debugger and other debugging tools</li><li>SetThreadIdealProcessor() is now used to assign threads to avaible CPU cores on the Win32 platform</li><li>new HTTP debug page for the Threading subsystem (currently only lists the active Nebula3 threads)</li><li>MiniDump support: crashes, n_assert() and n_error() now write MiniDump files on the Win32 platform</li><li>new Debug subsystem for code profiling:</li><ul><li>offers DebugTimer and DebugCounter objects</li><li>HTTP debug page allows to inspect DebugTimers and DebugCounters at runtime</li></ul><li>new Memory::MemoryPool class for allocation of same-size memory blocks (speeds up allocation and reduces heap fragmentation)</li><li>some new and renamed methods in Math::matrix44<br />    </li><li>Http subsystem now runs in its own thread</li><li>added SVG support to Http subsystem (Http::SvgPageWriter and Http::SvgLineChartWriter)</li><li>added IO::ExcelXMLReader stream reader class, allows to read XML-formatted MS Excel spreadsheet files</li><li>added Behaviour mode to Messaging::AsyncPort, defining how the handler thread should wait for new messages:</li><ul><li>WaitForMessage: block until message arrives</li><li>WaitForMessageOrTimeOut: block until message arrives or time-out is reached</li><li>DoNotWait: do not wait for messages</li></ul><li>added Remote subsystem, allows remote-controlling N3 applications through a TCP/IP connection</li></ul><div><span class="Apple-style-span"  style=" font-weight: bold; font-size:19px;">Render Layer</span><br /></div></div><ul><li>moved rendering into its own thread (InternalGraphics subsystem on the render-thread side, and Graphics front-end subsystem on the main-thread side)</li><li>added CoreAnimation and Animation subsystems (under construction)</li><li>added UI subsystem for simple user interfaces (under construction)</li><li>added CoreAudio and Audio subsystems (under construction):</li><ul><li>CoreAudio is the back-end and runs in its own thread</li><li>Audio is the "client-side" front-end in the main-thread (or any other thread)</li><li>designed around XACT concepts</li><li>comes with XACT wrapper implementation</li></ul><li>added CoreGraphics::TextRenderer and CoreGraphics::ShapeRenderer classes, both intended for rendering debug visualizations</li><li>added debug rendering subsystem (currently under the Debug namespace)</li><li>Frame subsystem: FramePostEffects may now contain FrameBatches</li><li>Input subsystem: disconnected XInput game-pad slots now only check every 0.5 seconds for connected game-pads</li><li>Resources subsystem: added ResourceAllocator/ResourceLump system to prepare for true resource streaming on console-platforms</li></ul><div><span class="Apple-style-span"  style=" font-weight: bold; font-size:19px;">Application Layer and Addons:</span><br /></div><ul><li>removed CoreFeature (this stuff had to go into the GameApplication class to prevent some chicken-egg problems)</li><li>added NetworkFeature (under construction)</li><li>added UIFeature (under construction)</li><li>new CoreNetwork and Multiplayer addon wrapper subsystems for RakNet</li></ul><div><br /></div><div><b>Please note the special RakNet licensing conditions. </b>Basically, RakNet is not free if used for a commercial project (<a href="http://www.jenkinssoftware.com/">http://www.jenkinssoftware.com/). Licensing details for 3rd party libs can be found on the Nebula3 documentation main page.</a></div><div><br /></div><h3>Stuff I want to do soon</h3><div><ul><li>fix the shader lighting code</li><li>add more shaders to bring the shader-lib up-to-par with N2</li><li>finish the CoreAnimation and Animation subsystems</li><li>design and implement proper skinned character rendering subsystem</li><li>add missing functionality to Audio subsystems (for instance sound categories) </li><li>make shaders SAS compatible so they work with tools like FXComposer</li><li>implement a proper resource-streaming system on the 360 (as proof on concept)</li><li>optimize messaging (use delegate-mechanism for dispatching, optimize message object creation, add double buffering behaviour to AsyncPort for less thread-synchronization overhead)</li></ul></div>