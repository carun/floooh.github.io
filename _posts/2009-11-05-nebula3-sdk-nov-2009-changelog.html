---
layout: post
title: Nebula3 SDK Nov 2009 Changelog
date: '2009-11-05T12:00:00.001+01:00'
author: Andre Weissflog
tags: 
modified_time: '2009-11-05T12:00:04.463+01:00'
blogger_id: tag:blogger.com,1999:blog-2948438400037317662.post-3247929137230012250
blogger_orig_url: http://flohofwoe.blogspot.com/2009/11/nebula3-sdk-nov-2009-changelog.html
---

<p></p>  <p>Here’s the new N3 SDK: <a href="http://213.191.63.156/n3_sdks/N3SDK_Nov2009.exe" target="_blank">download link</a></p>  <p>As always, this only includes the sources for the Win32 platform. Console platform specific source code (Xbox360, PS3 and Wii) is not included for obvious legal reasons.</p>  <p>Here’s a rough change log since the Apr2009 SDK:</p>  <h2>&#160;</h2>  <h2>== Major New Features</h2>  <ul>   <li>unified XNAMath support on Win32 and Xbox360 platforms </li>    <li>PS3 support (not part of public SDK, but lots of fixes for GCC 4.x in platform-agnostic code) </li>    <li>HTTP filesystem wrapper now working properly, this allows to create standalone N3 apps which load all their data from an HTTP server (see testhttpviewer.exe for an example) </li>    <li>“binary XML” support for much faster loading of big XML files (circumvents TinyXML) </li>    <li>new “FrameSync” system for running main and render thread in lock-step </li>    <li>new “Jobs” system to implement parallel jobs (CPU-thread-pool on Win32 and Xbox360, SPUs on PS3) </li>    <li>window parenting, it’s now possible to open the render window as a child of another window, this makes it possible to embed N3 into another Windows application </li>    <li>FMOD integration&#160; </li> </ul>  <p>&#160;</p>  <h2>== Foundation Layer</h2>  <h3>Core</h3>  <ul>   <li>new Debug::StringAtomPageHandler to inspect string atom table from web browser </li>    <li>type casting methods optimized in Ptr&lt;&gt; </li>    <li>optional allocation from memory pool support for RefCounted objects (currently unstable!) </li> </ul>  <h3>Util</h3>  <ul>   <li>Win32StringConverter: helper class to convert between UTF-8 and wide character string (currently only on Win32 platform) </li>    <li>Util::Array::InsertSorted() now returns index of inserted element </li>    <li>new Util::BitField&lt;&gt; class to allow bit mask operations on masks wider then 32 bits </li>    <li>removed classes of old string atom system: Util::Atom&lt;&gt;, Util::Proxy&lt;&gt; </li>    <li>new method Util::FixedArray&lt;&gt;::Resize() </li>    <li>classes for new string atom system: Util::StringAtom, Util::StringBuffer, Util::LocalStringAtomTable, Util::GlobalStringAtomTable </li>    <li>new method Util::Queue&lt;&gt;::Reserve() </li>    <li>new direct access methods in Util::RingBuffer&lt;&gt; </li>    <li>new method Util::Round::RoundUp() </li>    <li>new class Util::SparseTable, for 2D data tables with a lot of empty cells </li>    <li>Util::String:      <ul>       <li>new method CopyToBuffer() </li>        <li>new optimized versions of Tokenize() which fills a provided string array with the tokens, allows to reuse an existing array object </li>        <li>new static wrapper methods: IsDigit(), IsAlpha(), IsAlNum(), IsLower(), IsUpper(), StrCmp(), StrLen(), StrChr() </li>     </ul>   </li>    <li>new util functions to help with “type punning” </li> </ul>  <h4></h4>  <h3>IO</h3>  <ul>   <li>BXmlReader: stream reader for “binary XML files” (created by the new binaryxmlconverter3.exe utility) </li>    <li>some low-level-optimizations in ZIP filesystem wrapper </li>    <li>application root directory stuff moved from AssetRegistry into Core::CoreServer </li>    <li>new class GameContentServer, used to properly setup game data on some console platforms </li>    <li>added support for http: and httpnz: schemes for reading data from HTTP servers through the N3 filesystem wrapper </li> </ul>  <h3>Math</h3>  <ul>   <li>Xbox360 and Win32 math classes have been unified into XNAMath classes </li>    <li>low-level performance tweaking </li> </ul>  <h3>Memory</h3>  <ul>   <li>experimental memory pool support on Win32 platform </li>    <li>on Win32 platform, dynamically allocated memory is now 16-byte aligned (NOTE: there seems to be a hard to reproduce critical bug in Realloc() where HeapSize() returns a wrong value) </li>    <li>new HTML debug output in Debug::MemoryPageHandler for memory pools </li> </ul>  <h3>Threading</h3>  <ul>   <li>Threading::CriticalSection rewritten with &quot;Fast critical sections with timeout&quot; by Vladislav Gelfer (on Win32 platform) </li>    <li>Threading::Event now supports “manual reset” behaviour </li>    <li>Threading::Interlocked class now uses compiler intrinsics on Win32 and Xbox360 platform </li>    <li>new class Threading::ThreadBarrier: stops a thread until all other threads have arrived at the barrier </li>    <li>optimizations in Threading::SafeQueue </li> </ul>  <h3>System</h3>  <ul>   <li>new class System::Win32Environment to access environment variables (Win32 platform only) </li>    <li>Win32Registry class now reads registry key values as wide char and converts them to UTF-8 </li>    <li>type punning fixes in System::ByteOrder </li> </ul>  <h3>Timing</h3>  <ul>   <li>removed MasterTime/SlaveTime system, global timing is now provided by the FrameSync subsystem </li> </ul>  <h3>Messaging</h3>  <ul>   <li>the Message::SetHandled() method was not thread-safe, now uses Interlocked::Exchange() to update its status </li>    <li>Messaging::AsyncPort rewritten to allow better control over message handling behaviour through subclasses of HandlerThreadBase </li>    <li>new async message handler thread classes BlockingHandlerThread, RunThroughHandlerThread </li> </ul>  <h3>Net</h3>  <ul>   <li>some type punning fixes in debugpacket.cc </li> </ul>  <h3>Http</h3>  <ul>   <li>new classes HttpClientRegistry, HttpStream, HttpNzStream to implement a transparent HTTP filesystem, the HttpNzStream uses client-side zlib decompression to improve download performance </li> </ul>  <h4></h4>  <h3>Debug</h3>  <ul>   <li>no noteworthy changes </li> </ul>  <h3>App</h3>  <ul>   <li>new application identifier strings AppTitle and AppID, this is necessary for some console platforms </li> </ul>  <h3>Jobs</h3>  <ul>   <li>this is a new subsystem to distribute tasks either across threads in a thread-pool (Win32 and Xbox360) or the SPUs on the PS3 </li> </ul>  <h4></h4>  <h3>FrameSync</h3>  <ul>   <li>this is a new subsystem which implements better synchronization between the game thread and render thread </li> </ul>  <p>&#160;</p>  <h2>== Render Layer</h2>  <h3>CoreGraphics</h3>  <ul>   <li>parent window stuff in DisplayDevice (Win32 platform) </li>    <li>it’s now possible to share depth/stencil buffers between render targets </li>    <li>the ShaderServer now parses a dictionary file (created by the shaderbatcher3.exe tool) instead of listing the directory content of the shaders directory </li>    <li>removed array support from shader variables (shader parameter arrays are not very portable) </li>    <li>some restructuring because of the PS3 port (some classes have been split into a base class and platform specific derived classes) </li>    <li>new private method in D3D9RenderDevice: SyncGPU() this is called inside Present() to prevent the GPU from running too far ahead of the CPU (this is a driver-internal “optimization” which can lead to frame stuttering under some circumstances) </li>    <li>better control over clearing a render target through clear flags </li>    <li>the RenderDevice::SaveScreenshot() method is now responsible to set the MIME type on the output stream, this is because the actually saved MIME type may now be different then the requested type </li>    <li>no more byte-order conversion when loading mesh files, this happens in the asset pipeline now </li>    <li>new class MemoryMeshLoader, setup a mesh object from an existing VertexBuffer and IndexBuffer object </li> </ul>  <h3>CoreAudio and Audio</h3>  <ul>   <li>the CoreAudio and Audio subsystem are obsolete and have been replaced with the FMOD-based Audio2 subsystem, which “automatically” works across all platforms, please check the FMOD license restrictions for commercial projects! </li> </ul>  <h3>CoreAnimation</h3>  <ul>   <li>the following classes have been removed from CoreAnimation: AnimDrivenMotionSampler, AnimMixer, AnimSampler </li>    <li>new file format for animation data: nax3 </li>    <li>new animation curve type: Velocity, this is used by the AnimDrivenMotion feature </li> </ul>  <h3>Input</h3>  <ul>   <li>no noteworthy changes </li> </ul>  <h3>Frame</h3>  <ul>   <li>minor changes for Pre-Lightpass-Rendering </li>    <li>better control over render target clear in FramePass </li>    <li>FramePostEffect: rendering a full-screen-quad has been moved into new helper class RenderUtil::DrawFullScreenQuad </li>    <li>frame shaders are now loaded on demand </li>    <li>new LightServer class: LightPrePassServer implements light pre-pass rendering (a variation on deferred shading, currently only implemented in the PS3 port) </li> </ul>  <h3>Animation</h3>  <ul>   <li>anim evaluation has been “jobified” </li>    <li>no more AnimDrivenMotion specific code in Animation subsystem (this is now handled through a new anim curve type which contains velocity keys) </li> </ul>  <h3>Audio2</h3>  <ul>   <li>new FMOD-based multiplatform audio subsystem </li> </ul>  <h3>Characters</h3>  <ul>   <li>skeleton evaluation has been “jobified” </li>    <li>on PS3, skinning is now running on SPUs </li>    <li>the entire character subsystem has been optimized (essentially rewritten) </li> </ul>  <h3>InternalGraphics</h3>  <ul>   <li>uses the FrameSync subsystem to run render thread and game thread in lock-step (this basically fixes all stuttering problems) </li>    <li>more debug infos displayed in web browser through GraphicsPageHandler </li>    <li>lots of fixes to the attachment system (character joint attachments: swords, shields, etc…) </li>    <li>restructured the Update/Render-Loop for better parallelization support, the idea is basically to make more room between updating an object and rendering an object so that asynchronous jobs have a better chance to finish on time before rendering requires the jobs output data </li> </ul>  <h3>Graphics</h3>  <ul>   <li>some new messages to communicate from the main thread to the render thread (see graphicshandler.cc) </li> </ul>  <h3>Models</h3>  <ul>   <li>nothing noteworthy… </li> </ul>  <h3>Particles</h3>  <ul>   <li>some restructuring for better portability </li>    <li>particle updates have been “jobified” </li> </ul>  <h3>RenderModules</h3>  <ul>   <li>no noteworthy changes… </li> </ul>  <h3>RenderUtil</h3>  <ul>   <li>new helper class RenderFullScreenQuad </li>    <li>new helper class NodeLookupUtil to lookup a ModelNodeInstance in a hierarchy </li> </ul>  <h3>Resources</h3>  <ul>   <li>nothing noteworthy </li>    <li></li> </ul>  <h2>== Moved into Addons:</h2>  <ul>   <li>fx </li>    <li>network </li>    <li>locale </li>    <li>posteffect </li>    <li>ui </li>    <li>vegetation </li>    <li>vibration </li>    <li>video </li> </ul>  <h2>== New Stuff in ExtLibs:</h2>  <ul>   <li>FMOD </li>    <li>RakNet </li> </ul>  <p>Enjoy!</p>  